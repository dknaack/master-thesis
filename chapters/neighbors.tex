\chapter{Choosing the Closest Pair of Neighbors}

In this chapter, the following strategy is analyzed:

\begin{enumerate}
  \item Sort $x$ in increasing order.
  \item Find the index $ℓ$ which minimizes $\{x_{ℓ+1}/x_ℓ\}$.
  \item Choose $ℓ$ in the first iteration and $ℓ + 1$ in the second iteration.
\end{enumerate}

\todo[inline]{Remark about the endpoints, $0$ and $1$.}

\section{Why the Strategy is Better than Choosing the Minimum}

The strategy is so effective, because the determinant decreases by a larger
factor than simply choosing the minimum in each iteration.
Whereas the minimum only guaranteed a decrease of at least $1/2$,
this strategy guarantees a decrease of at least $1/(d+1)$ over two iterations.

\begin{theorem}
  The determinant decreases by a factor of at least $1/(d+1)$ over two iterations
  using the closest neighbor strategy.
\end{theorem}

\begin{proof}
  Let $x ∈ ℚ^d$ with $0 < x_i < 1$ for every $1 ≤ i ≤ d$.
  We assume $x$ is already given in increasing order.
  We additionally define $x_0 = 0$ and $x_{d+1} = 1$.
  Suppose that pivoting with any $ℓ ∈ \{0, 1, \dots, d\}$
  decreases the determinant slower than $(d+1)$ over two iterations,
  i.e.
  \[
    % TODO: Handle ℓ = 0 case, (just a formality)
    x_1 > \frac{1}{d+1},
    \quad \text{ and } \quad
    x_\ell \left\{\frac{x_{\ell+1}}{x_\ell}\right\} > \frac{1}{d+1}, \quad \text{ for all } 1 ≤ ℓ ≤ d.
  \]
  Because $x_{\ell+1} > x_\ell$, we have
  \[
    x₁ - x₀ > \frac{1}{d+1},
    \quad \text{ and } \quad
    x_{\ell+1} - x_\ell ≥ x_\ell \left\{\frac{x_{\ell+1}}{x_\ell}\right\} > \frac{1}{d+1}.
  \]

  The inequality tells us, that the distance between all neighbors
  (including $1$ and $0$) must be greater than $1/(d+1)$.
  Or equivalently, we must space our $d$ variables on the unit interval such that they
  divide it into $d+1$ intervals and each interval is larger than $1/(d+1)$.

  {\begin{center}
    \begin{tikzpicture}
      \def\one{0.8 \textwidth}
      \draw (0, 0) -- (\one, 0);

      \draw (0, -0.2) -- (0, 0.2) node[above] {$x₀$};
      \draw (\one, -0.2) -- (\one, 0.2) node[above] {$x_{d+1}$};
      \draw ({3.5 * \one / 5}, 0.2) node[above] {$\dots$};

      \foreach \x/\y in {1,...,3,4/d}
        \draw ({\x * \one / 5}, -0.2) -- ({\x * \one / 5}, 0.2) node[above] {$x_{\y}$};
      \foreach \x in {1,...,3,5}
        \draw[decorate, line width=1.25pt, decoration={calligraphic brace, mirror}]
          ({(\x - 1) * \one / 5 + 1}, -0.3) -- node[below] {$> \frac{1}{d+1}$} ({\x * \one / 5 - 1}, -0.3);
    \end{tikzpicture}
  \end{center}}

  However, no such values can exist.
  The maximum size we can achieve is exactly $1/(d+1)$ by evenly
  spacing the values.
  Moving one value increases the size of one interval, but decreases the size
  of the other interval.
  Therefore, we must have a decrease of at least $(d+1)$ over two iterations.
\end{proof}

\section{Finding the Golden Ratio}

To find a generalization of the golden ratio for this strategy,
we first have to establish an equation for the decrease of the determinant.
The decrease must stay the same in each iteration.
Hence, we should choose values for $x₁, \dots, x_d$ such that the decrease
stays the same for all possible combinations.
\begin{equation}
  \label{eq:equal-neighbor-distance}
  x_1 = \frac{x_2}{x_1} - 1 = \frac{x_3}{x_2} - 1 = \dots = \frac{x_d}{x_{d-1}} = \frac{1}{x_d} - 1.
\end{equation}
Solving the equation for $x₁$ yields the following solution:
\[
  x_d^{d+1} + x_d - 1 = 0 \text{ and } x_i = x_d^{d+1-i} \text{ for } i < d.
\]

Just like the minimum strategy, $x_d$ is the real positive root of a polynomial $p(x)$
and the other values are chosen according to $x_d$.
We can extend the rational number $ℚ$ with the algebraic number $x_d$ and then
see if the algorithm is periodic for our input $x ∈ ℚ(x_d)$.
Because $x_d$ is real, we have an embedding $σ \colon ℚ(x_d) → ℝ$,
which we can use to compute $\lfloor y \rfloor$ for any $y ∈ ℚ(x_d)$.

\begin{table}[b]
  \label{tbl:equal-neighbor-distance}
  \caption{
    The first ten iterations of the algorithm with the solution from
    Equation~\ref{eq:equal-neighbor-distance}.
    In the first iteration, $x₁$ is chosen, since all distances between the
    neighbors are equal and $x₁$ is the smallest element.
    The first and second pivot $ℓ₁, ℓ₂$ are shown.
    In case $ℓ₁$ or $ℓ₂$ are not shown, then only one pivot is performed.}
  \centering
  \input{tables/equal-neighbor-distance.tex}
\end{table}

Unfortunately, the algebraic solution falls apart after just two iterations.
In the first iteration, the choice does not matter since, by construction, all
distances between neighbors are equal.
Because all distances are equal, it would make the most sense to choose the
smallest element since that would guarantee the largest decrease in the
determinant.
However, choosing this element also destroys our structure given by the initial
equation.
See Table~\ref{tbl:equal-neighbor-distance} for an example run with $d = 3$.

\begin{itemize}
  \item \textbf{Polynomial}: \[x^{d+1} + x - 1 = 0.\]
  \item \textbf{Algebraic Solution Vector}: \[x_i = \psi^{d+1-i}.\]
  \item \textbf{Linear Recurrence}: \[F(n + 1) = F(n) + F(n - d).\]
  \item \textbf{Rational Solution Vector}: \[x_i = \frac{F(n)}{F(n-d+i)}.\]
  \item \textbf{Matrix}:
    \[\left(\begin{array}{cccc|c}
      F(n)   & 0      & \dots  & 0      & F(n - d) \\
        0    & F(n)   & \dots  & 0      & F(n - d + 1) \\
      \vdots & \vdots & \ddots & \vdots & \vdots   \\
        0    & 0      & \dots  & F(n)   & F(n - 1) \\
    \end{array}\right)\]
\end{itemize}

The algebraic solution falls apart after two iterations when pivoting with the
smallest element, i.e. $x_1$.

\section{Fibonacci Numbers}


