\chapter{Experimental Analysis of the Periodicity}

\section{Finding a Periodic Representation through Brute Force}

The generalized Euclidean algorithm allows us for one additional degree of
freedom.
We have already seen that in the case of Fibonacci numbers,
that different strategies in the choice of our pivot element will only allow
certain irrationals.
Therefore, to find a strategy for \emph{all} irrationals we simply try all strategies.

\begin{Pseudocode}[float=tbp, label={lst:bfs}, caption={The brute-force search algorithm for finding a periodic representation.}]
algorithm $\textsc{brute-force-search}(x, N)$
  for $L ∈ \{1, …, d\}^{≤ N}$ do
    $x₀ ← x$
    for $i ∈ \{1, …, |L|\}$ do
      $x_i ← \mathrm{pivot}_{L[i]}(x_{i-1})$
      if $x_i$ occurred twice then
        Find the index $j ≠ i$ where $x_j = x_i$
        $S ← L[1] \,…\, L[j]$
        $P ← L[j+1] \,…\, L[i]$
        return $(S, P)$
  return $ε$
\end{Pseudocode}

Given a real number $r ∈ ℝ$, we use the update rule from the generalized
algorithm to find its representation.
Of course, the update rule does not take a real number but a vector as input,
so we use the initial vector $x_i = q_i(r)$ for $i ≤ d$, where $q_i$ is an
arbitrary polynomial of degree $i$.
Most of the time we will use $q_i(r) = r^i$ as our polynomials.

Now that we have our input vector $x ∈ ℝ^d$, we need to find a possible
sequence of indices $ℓ_1, ℓ_2, …, ℓ_N$, where updating $x$ with those
indices leads to one vector occurring twice.
In order to find this sequence, we try every possible sequence
$ℓ_1, ℓ_2, … ∈ \{1, …, d\}^*$ until we find some duplicate vector.
In particular, we use a breadth-first search over the sequences.
We begin with all sequences of length $1$ and see if any vector occurs twice.
If not, then we continue with all sequences of length $2$ and check again if
any previous vector has occurred twice.
We continue this process indefinitely until we hopefully find a duplicate vector.

% Example?
\begin{example}
  Given $r = \sqrt[3]{2}$, we construct the input vector $x = \left(\sqrt[3]{2}, \sqrt[3]{4}\right)$.
  For this input, the algorithm finds the sequence $0\overline{10}$.

  % TODO: Include the whole example.
\end{example}

% Wait, how would we represent non-cubic irrationals? I guess we could include
% the whole tree. There should be a discussion about representing non-cubic
% irrationals and also that the end goal would be to find the actual strategy
% behind the brute-force search or at least one possible strategy, it might not
% have to be the optimal one which returns the result from the brute force
% search exactly.

% I think for this discussion it would be good to present the case for a
% minimum continued fraction or even the ternary continued fractions. This
% would sort of present the brute-force search more as a meta-proof on all
% Jacobi-Perron type algorithm which could be periodic.

If we do find a duplicate, then the representation for that number will be unambiguous.
However, if we don't, then it is unclear how we will represent that number.
One possible solution is to simply include everything, the whole tree.
The aim of this algorithm is not to find a representation in and of itself,
but to aid in finding one possible strategy for our goal.
In the end, we might only need to look at all sequences of length $d$ at every
iteration to find the optimal choice.
In the worst case, there would be no strategy we can follow to determine a
periodic representation for cubic irrationals.


% TODO: Maybe replace this with the pseudocode instead?
\begin{minipage}{0.48\textwidth}
\begin{Python}[basicstyle=\tiny\ttfamily, frame={}]
def brute_force_search(xs, max_depth):
    d = len(xs)
    for L in sequences(d, max_depth):
        ys = tuple(xs)
        index = {ys: 0}
        for i, l in enumerate(L):
            ys = pivot(ys, l)
            if ys in index:
                j = index[ys]
                start = L[:j]
                period = L[j:i+1]
                return start, period
            else:
                index[ys] = i + 1
\end{Python}
\end{minipage}
\vrule width 1pt
\hfill
\begin{minipage}{0.48\textwidth}
\begin{Python}[basicstyle=\tiny\ttfamily, frame={}]
def sequences(base, max_digits):
    seq = []
    while True:
        carry = 1
        for i in range(len(seq)-1, -1, -1):
            seq[i] += carry
            if seq[i] == base:
                seq[i] = 0
                carry = 1
            else:
                carry = 0
                break
        if carry:
            if len(seq) < max_digits:
                seq.insert(0, 1)
            else:
                break
        yield seq[1:]
\end{Python}
\end{minipage}

\section{Results for Cubic Irrationals}

\begin{example}
  The sequences for the prime numbers are:
  \begin{itemize}
    \item $2^{1/3}$: $0\overline{10}$.
    \item $3^{1/3}$: $01\overline{01}$.
    \item $5^{1/3}$: $0\overline{00111000}$.
    \item $7^{1/3}$: $0\overline{010100}$.
    \item $11^{1/3}$: $0\overline{1100}$.
    \item $13^{1/3}$: $00\overline{010000}$.
    \item $17^{1/3}$: $000\overline{11110000}$.
    \item Another choice for $5^{1/3}$ with shorter period: $00110\overline{101010}$.
  \end{itemize}
\end{example}

\begin{remark}
  The first number that has a leading $1$ as the pivot is $12$,
  which has the pivot sequence $1\overline{0111011101}$.
  However, there are other possible choices where it does not have a leading $0$.
\end{remark}

\begin{table}[t]
  \caption{Representation of $ψ = \sqrt[3]{4}$ using the brute-force search.}
  \label{table:cube-root-4}
  \centering
  \input{tables/cube-root-4.tex}
\end{table}

\begin{table}[t]
  \caption{Period Length of the first $28$ numbers.}
  \centering
  \input{tables/period-length.tex}
\end{table}

\section{Results for Quartic and Higher-Degree Irrationals}

\section{Evaluation of More Efficient Search Strategies}

We can likely rule out alternating pivot sequences since this corresponds to
the Jacobi-Perron algorithm and for this algorithm it is conjectured
\cite{Karpenkov21} that the algorithm is not periodic for $\sqrt[3]{4}$.
However, the brute-force algorithm is periodic for this input (see Table~\ref{table:cube-root-4}).

The choice of the initial input also matters.
We generally choose $x = (α, q(α))$, where $q$ is some polynomial of degree $2$.
But different choices of $q$ produce different sequences.
For example, $(\sqrt[3]{2}, \sqrt[3]{4})$ produces a different sequence of coefficients than $(\sqrt[3]{2}, \sqrt[3]{6})$.
Even though both inputs represent the same number $\sqrt[3]{2}$.
Choosing $q(α) = α^2 - α$ makes the sequence purely periodic for $\sqrt[3]{3}$ and $\sqrt[3]{4}$.
