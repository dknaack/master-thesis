\chapter{Multi-Dimensional Continued Fractions}

Continued fractions are fractions of the form
\[
  a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{a_4 + \ddots}}}},
\]
where $a₀$ can be any integer and $a₁, a₂, \dots$ must be positive integers.
We have already seen these fractions when analyzing the Euclidean algorithm,
where they determine the number of steps for the algorithm.
Naturally, the continued fractions can be extended to higher dimensions by
reversing the generalized Euclidean algorithm.

\section{Reversing the Pivot Operation}

We can reverse the pivot operation.
In this case, the inverse operation takes not only the output and the index $ℓ$,
but also the integer part $a = (a₁, \dots, a_d)$ of each input value.
Given $x ∈ ℚ^d$, an index $ℓ$ and $a ∈ ℤ^d$ with $a_ℓ ≠ 0$,
the vector $x = pivot^{-1}(y, ℓ, a)$ is defined as follows:
\[
  x_ℓ = a_ℓ + \frac{1}{y_ℓ}, \quad x_i = a_i + \frac{y_i}{y_ℓ} \text{ for } i ≠ ℓ.
\]
The reverse pivot operation allows us to describe any rational vector $x ∈ ℚ^d$ as a
sequence of indices $ℓ$ and integer vectors $a$.

However, this representation is not unique for every vector,
since any vector with at least two non-integer numbers has two different
choices for the pivot $ℓ$.
Hence, we can find at least two different representations for this vector.

Not only do we have $d$ sequences $a_1^{(n)}, \dots, a_d^{(n)}$ but also a
sequence $L ∈ \{0,1\}^*$ for the pivots.

\[
  \begin{array}{rl rl l}
    r_i^{(ε)} & = a_i^{(ε)}, &&
    & \quad (i = 1, \dots, d) \\
    r_{ℓ}^{(ℓ ∘ L)} & = a_{ℓ}^{(ℓ ∘ L)} + \frac{1}{r_{ℓ}^{(L)}},
    & \quad r_{i}^{(ℓ ∘ L)} & = a_{i}^{(ℓ ∘ L)} + \frac{r_i^{(L)}}{r_{ℓ}^{(L)}},
    & \quad (i ≠ ℓ,\, L ∈ \{0, 1\}^*) \\
  \end{array}
\]
Clearly, for every convergent $r^{(L)}$ we can find integers $p₁^{(L)}, \dots, p_d^{(L)}$
and $q₁^{(L)}, \dots, q_d^{(L)}$ such that
\[
  r_i^{(L)} = \frac{p_i^{(L)}}{q_i^{(L)}}.
\]
We can use the previous equation to construct the values.
\[
  \begin{array}{rllll}
    r_i^{(ε)}
    & = a_i^{(ε)}
    & = \frac{a_i^{(ε)}}{1}
    & = \frac{p_i^{(ε)}}{q_i^{(ε)}},
    & \quad (i = 1, \dots, d), \\
    r_ℓ^{(ℓ ∘ L)}
    & = a_ℓ^{(ℓ ∘ L)} + \frac{1}{r_ℓ^{(L)}}
    & = a_ℓ^{(ℓ ∘ L)} + \frac{q_ℓ^{(L)}}{p_ℓ^{(L)}}
    & = \frac{a_ℓ^{(ℓ ∘ L)} p_{ℓ}^{(L)} + q_ℓ^{(L)}}{p_ℓ^{(L)}}, \\
    r_{i}^{(ℓ ∘ L)}
    & = a_{i}^{(ℓ ∘ L)} + \frac{r_i^{(L)}}{r_ℓ^{(L)}}
    & = a_{i}^{(ℓ ∘ L)} + \frac{p_i^{(L)}}{q_i^{(L)}} \frac{q_ℓ^{(L)}}{p_ℓ^{(L)}}
    & = \frac{a_{i}^{(ℓ ∘ L)} q_i^{(L)} p_ℓ^{(L)} + p_i^{(L)} q_ℓ^{(L)}}{q_i^{(L)} p_ℓ^{(L)}}.
    & \quad (i ≠ ℓ) \\
  \end{array}
\]
In summary, we have
\[
  \begin{aligned}
    p_ℓ^{(ℓ ∘ L)} & = a_ℓ^{(L)} p_ℓ^{(L)} + q_ℓ^{(L)}                     \\
    p_i^{(ℓ ∘ L)} & = a_i^{(L)} q_i^{(L)} p_ℓ^{(L)} + p_i^{(L)} q_ℓ^{(L)} \\
  \end{aligned}
  \quad \text{ and } \quad
  \begin{aligned}
    q_ℓ^{(ℓ ∘ L)} & = p_ℓ^{(L)}           \\
    q_i^{(ℓ ∘ L)} & = q_i^{(L)} p_ℓ^{(L)} \\
  \end{aligned}.
\]

\begin{lemma}
  If $L = ℓ^*$, then
  \[
    \begin{aligned}
      p_ℓ^{(ℓ ∘ ℓ ∘ L)} & = a_ℓ^{(ℓ ∘ L)} p_ℓ^{(ℓ ∘ L)} + p_ℓ^{(L)}                                 \\
      p_i^{(ℓ ∘ ℓ ∘ L)} & = a_i^{(ℓ ∘ L)} q_i^{(ℓ ∘ L)} p_ℓ^{(ℓ ∘ L)} + p_i^{(ℓ ∘ L)} q_ℓ^{(ℓ ∘ L)} \\
    \end{aligned}
    \quad \text{ and } \quad
    \begin{aligned}
      q_ℓ^{(ℓ ∘ ℓ ∘ L)} & = a_ℓ^{(L)} q_ℓ^{(ℓ ∘ L)} + q_ℓ^{(L)} \\
      q_i^{(ℓ ∘ ℓ ∘ L)} & = q_i^{(ℓ ∘ L)} q_ℓ^{(ℓ ∘ ℓ ∘ L)}     \\
    \end{aligned},
  \]
  where $i ≠ ℓ$.
\end{lemma}

\begin{proposition}
  Given $x ∈ ℝ^d$, the continued fraction of $x$ is periodic with one index if
  and only if $x$ consists solely of rational numbers or quadratic irrationals.
\end{proposition}

\begin{proof}
  Suppose the continued fraction of $x$ is periodic with index $ℓ$.
  Then, $x_ℓ$ must be a quadratic irrational.
\end{proof}

\section{Comparison to Ternary Continued Fractions}

Ternary continued fractions, also called bifurcating continued fractions \cite{Gupta00},
have been proposed as a way to represent roots of polynomials with higher degree.
They follow directly from the Jacobi-Perron algorithm,
where we rotate the pivots in each round.
However, not all ternary continued fractions arise from the Jacobi-Perron algorithm.
There are certain fractions which cannot be produced from the algorithm.

Ternary continued fractions are two fractions of the form
\[
  α = a_0 + \cfrac{b_1 +
    \cfrac{
      1
    }{
      \displaystyle a_2 + \cfrac{b_3 +
        \cfrac{1}{\ddots}
      }{
        a_3 + \cfrac{\ddots}{\ddots}
      }
    }
  }{
    a_1 + \cfrac{
      \displaystyle b_2 + \cfrac{
        1
      }{
        a_3 + \cfrac{\ddots}{\ddots}
      }
    }{
      \displaystyle a_2 + \cfrac{
        b_3 + \cfrac{1}{\ddots}
      }{
        a_3 + \cfrac{\ddots}{\ddots}
      }
    }
  },
    \text{ and }
  β = b_0 + \cfrac{
    1
  }{
    a_1 + \cfrac{
      b_2 + \cfrac{1}{
        a_3 + \cfrac{\ddots}{\ddots}
      }
    }{
      a_2 + \cfrac{
        b_3 + \cfrac{1}{\ddots}
      }{
        a_3 + \cfrac{\ddots}{\ddots}
      }
    }
  }
\]

\section{Continued Fractions for the Minimum Strategy}

The first strategy was choosing the minimal fractional value in each iteration.
For the corresponding multi-dimensional continued fraction,
we actually choose the maximum out of all elements.
Suppose we have an input vector $x$ along with its integer part $a$.
Then, the fractional value $x_ℓ - a_ℓ$ is minimal among all other elements of $x$.
Hence, in the continued fraction representation
\[
  x_ℓ - a_ℓ = \frac{1}{y_ℓ} < \frac{y_i}{y_ℓ} = x_i - a_i.
\]
Because we are dealing with fractional values, this means that both values must
me smaller than one and then $y_i$ must be smaller than $y_ℓ$.
From this, it follows that choosing the smallest fractional value corresponds
to choosing the largest value from the multi-dimensional continued fraction.

This allows us to remove the index from the previously-defined representation.
We can simply infer the index from the fractions themselves.

\begin{definition}
  Let $a_1, \dots, a_d ∈ ℤ$ and $a_{d+1}, \dots, a_{dn} ∈ ℤ_{> 0}$ for $n ≥ 0$.
  The maximum continued fractions are defined as:
  \begin{enumerate}
    \item If $n = 1$, then $[a_i, \dots, a_d] := a_i$ for $i ≤ d$.
    \item If $n > 1$, then let
      $ℓ = \argmax_i \, [a_{d+i}, \dots, a_{dn}]$ and
    \begin{align*}
      [a_i, \dots, a_{dn}]
      & :=
      \begin{cases}
        \displaystyle
        a_i + \frac{[a_{d+i}, \dots, a_{dn}]}{[a_{d+ℓ}, \dots, a_{dn}]},
        & \text{ if } i = ℓ, \\
        \displaystyle
        a_ℓ + \frac{1}{[a_{d+ℓ}, \dots, a_{dn}]},
        & \text{ otherwise. }
      \end{cases}
    \end{align*}
  \end{enumerate}
\end{definition}

\begin{remark}
  In case of a tie, we choose the first element.
  In particular, when the last $d$ elements of the sequence are all equal, then we define $\argmax_i a_i = 1$.
  \todo[inline]{%
    Does this actually lead to the same numbers as the algorithm itself?
    Could there me multiple inputs which lead to the same sequence?}
\end{remark}

\begin{lemma}
  Given a continued fraction $x = [a₁, \dots, a_{dn}]$,
  the generalized Euclidean algorithm requires exactly $n - 1$ steps
  when choosing the minimum fractional value.
\end{lemma}

\begin{proof}
  When $n = 1$, the input consists solely of integers.
  Therefore, the Euclidean algorithm immediately stops.
  Per induction, assume that the algorithm requires $n - 2$ steps for
  the continued fraction $x' = [a_{d+1}, \dots, a_{2d}; a_{2d+1}, \dots, a_{dn}]$.
  Given $x$, the algorithm chooses the minimum fractional value $\{x_ℓ\}$.
  \todo[inline]{Finish this proof.}
\end{proof}

\begin{lemma}
  Let $b$ be the largest denominator in $x ∈ ℚ^d$.
  If $b$ is greater than the $n$-th $d$-bonacci number $F(n)$,
  then the algorithm takes at least $n$ steps.
\end{lemma}

\begin{proof}
  \todo[inline]{Prove this.}
\end{proof}

The smallest purely periodic continued fraction is $[\overline{1, \dots, 1}]$.

\section{Neighbor Continued Fractions}

\todo[inline]{What fractions result from the closest neighbor strategy?}
